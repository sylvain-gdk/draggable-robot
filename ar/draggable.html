<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>jQuery UI Draggable - Default functionality</title>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">

    <style>
      /* position first appearance of puzzle pieces */
      .start { position: fixed; left: 0; top: 432px; }

      /* rotate puzzle pieces */
      .rotate90 {
        -webkit-transform: rotate(90deg);
        transform: rotate(90deg);
      }
      .rotate180 {
        -webkit-transform: rotate(180deg);
        transform: rotate(180deg);
      }
      .rotate270 {
        -webkit-transform: rotate(270deg);
        transform: rotate(270deg);
      }
      .rotate360 {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }


      /* distribute puzzle pieces in 3x3 */
      * { box-sizing: border-box; }
      body, figure { margin: 0; }
      img, button { display: block; width: 100%;}

      @media (min-width: 12em) {
        figure {
          display: block;
          float: left;
          width: 33%;
        }
      }

      /* reset/replay button */
      button {width: 50%; margin-top: 10px; margin-left: 25%; margin-right: 25%}

    </style>

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <script src="https://digital.nightspublications.com/js/jquery.ui.touch-punch.min.js"></script>

    <script>

      /* counts until puzzle is completed */
      var count = 1;

      /* compares position of one piece against target */
      function compare(id, ui, target){
        if((Math.floor(ui.position.top) == target.offsetTop || Math.ceil(ui.position.top) == target.offsetTop) && (Math.floor(ui.position.left) == target.offsetLeft || Math.ceil(ui.position.Left) == target.offsetLeft)){
          /* adds 1 when in place */
          count++;
          /* disables drag when in place */
          $( id ).draggable( "disable" );
          /* shows next piece of puzzle */
          switch(count){
            case 2:
              document.getElementById("img2").src = "./images/robot-character_BCKG2.png";
              break;
            case 3:
              document.getElementById("img3").src = "./images/robot-character_BCKG3.png";
              break;
            case 4:
              document.getElementById("img4").src = "./images/robot-character_BCKG4.png";
              break;
            case 5:
              document.getElementById("img5").src = "./images/robot-character_BCKG5.png";
              break;
            case 6:
              let hide = document.getElementsByTagName("img");
              for(var i = 0; i < hide.length; i++){
                hide[i].src = "";
              }
            /* shows animation when puzzle is completed */
            var animate = document.getElementById("animate");
            animate.src = "./images/robot-character_ANIME.gif";
            var again = document.getElementById("again");
            again.innerHTML = "Play again?";
          }
        }
      }

      /* rotates the piece of puzzle when clicked until in the right position */
      function rotate(figId, imgId, amount) {
        var newAmount;
        if(amount != 360){
          newAmount = amount + 90;
          var figure = document.getElementById(figId);
          var figString = 'start ui-draggable ui-draggable-handle rotate' + newAmount;
          figure.setAttribute("class", figString);

          var img = document.getElementById(imgId);
          var imgString = 'rotate("' + figId + '", "' + imgId + '", ' + (newAmount) + ')';
          img.setAttribute("onclick", imgString);
        }
      }

      $( function() {
        $( "#image1" ).draggable({
          snap: ".ui-widget-image2",
          snapMode: "inner",
          opacity: 0.35,
          stop: function(event, ui){
            let target = document.getElementById("snaptarget2");
            compare(this, ui, target);
          }
        });
      } );

      $( function() {
        $( "#image2").draggable({
          snap: ".ui-widget-image4",
          snapMode: "inner",
          opacity: 0.35,
          stop: function(event, ui){
            let target = document.getElementById("snaptarget4");
            compare(this, ui, target);
          }
        });
      } );

      $( function() {
        $( "#image3" ).draggable({
          snap: ".ui-widget-image5",
          snapMode: "inner",
          opacity: 0.35,
          stop: function(event, ui){
            let target = document.getElementById("snaptarget5");
            compare(this, ui, target);
          }
        });
      } );

      $( function() {
        $( "#image4" ).draggable({
          snap: ".ui-widget-image6",
          snapMode: "inner",
          opacity: 0.35,
          stop: function(event, ui){
            let target = document.getElementById("snaptarget6");
            compare(this, ui, target);
          }
        });
      } );

      $( function() {
        $( "#image5" ).draggable({
          snap: ".ui-widget-image8",
          snapMode: "inner",
          opacity: 0.35,
          stop: function(event, ui){
            let target = document.getElementById("snaptarget8");
            compare(this, ui, target);
          }
        });
      } );

    </script>
  </head>

  <body>

    <div>
      <img id = "animate" src=""/>
    </div>

    <figure>
      <img src="./images/robot-character_EMPTY_01.png"/>
    </figure>

    <figure id="snaptarget2" class="ui-widget-image2">
      <img src="./images/robot-character_EMPTY_02.png"/>
    </figure>

    <figure>
      <img src="./images/robot-character_EMPTY_03.png"/>
    </figure>

    <figure id="snaptarget4" class="ui-widget-image4">
      <img src="./images/robot-character_EMPTY_04.png"/>
    </figure>

    <figure id="snaptarget5" class="ui-widget-image5">
      <img src="./images/robot-character_EMPTY_05.png"/>
    </figure>

    <figure id="snaptarget6" class="ui-widget-image6">
      <img src="./images/robot-character_EMPTY_06.png"/>
    </figure>

    <figure>
      <img src="./images/robot-character_EMPTY_07.png"/>
    </figure>

    <figure id="snaptarget8" class="ui-widget-image8">
      <img src="./images/robot-character_EMPTY_08.png"/>
    </figure>

    <figure>
      <img src="./images/robot-character_EMPTY_09.png"/>
    </figure>






    <figure id="image1" class="start rotate270">
      <img id="img1" src="./images/robot-character_BCKG1.png" onclick='rotate("image1", "img1", 90)'/>
    </figure>

    <figure id="image2" class="start rotate90" >
      <img  id="img2" src="" onclick='rotate("image2", "img2", 90)'/>
    </figure>

    <figure id="image3" class="start rotate180">
      <img id="img3" src="" onclick='rotate("image3", "img3", 90)'/>
    </figure>

    <figure id="image4" class="start rotate270">
      <img id="img4" src="" onclick='rotate("image4", "img4", 90)'/>
    </figure>

    <figure id="image5" class="start rotate180">
      <img id="img5" src="" onclick='rotate("image5", "img5", 90)'/>
    </figure>

    <button id="again" style="font-size: 30px" onclick="location.href='./draggable.html';">
      Reset
    </button>

  </body>
</html>